@model ACCDataStore.Web.Areas.SchoolProfiles.ViewModels.SchoolProfiles.IndexPrimarySchoolProfilesViewModel
@using System.Data;
@using Newtonsoft;
    
@section Header {
    @*<link rel="stylesheet" href="~/Content/accdatastore/areas/nationality/views/nationality/nationality.css" type="text/css" />*@
<script src="~/Scripts/accdatastore/areas/schoolprofiles/views/IndexSchoolProfile/IndexPrimarySchool.js"></script>
<!-- Bootstrap Multiselect Plugin -->
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<link href="~/Content/bootstrap.min.css" rel="stylesheet" type="text/css" />
<script src="~/Scripts/jquery.js"></script>
<script type="text/javascript" src="~/Scripts/bootstrap.min.js"></script>
<script src="~/Scripts/bootstrap-multiselect.js" type="text/javascript"></script>
<link href="~/Content/bootstrap-multiselect.css" rel="stylesheet" type="text/css" />
<script src="https://cdn.datatables.net/1.10.11/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/buttons/1.1.2/js/dataTables.buttons.min.js"></script>
<script src="https://cdn.datatables.net/fixedcolumns/3.2.2/js/dataTables.fixedColumns.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/jszip/2.5.0/jszip.min.js"></script>
<script src="//cdn.rawgit.com/bpampuch/pdfmake/0.1.18/build/pdfmake.min.js"></script>
<script src="//cdn.rawgit.com/bpampuch/pdfmake/0.1.18/build/vfs_fonts.js"></script>
<script src="//cdn.datatables.net/buttons/1.1.2/js/buttons.html5.min.js"></script>
<script src="//cdn.datatables.net/buttons/1.1.2/js/buttons.print.min.js"></script>
<link rel="stylesheet" href=" https://cdn.datatables.net/1.10.11/css/jquery.dataTables.min.css" type="text/css" />
<link rel="stylesheet" href=" https://cdn.datatables.net/buttons/1.1.2/css/buttons.dataTables.min.css" type="text/css" />
<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/modules/data.js"></script>
<script src="https://code.highcharts.com/modules/exporting.js"></script>
<script src="https://code.highcharts.com/highcharts-3d.js"></script>
}


@{
    ViewBag.Title = "Index";
}

        <!-- Initialize the plugin: -->
<script>

    var year = '@Model.selectedYear.academicyear';

    $(document).ready(function () {

        var selectid = function () { return @Html.Raw(Json.Encode(Model.listSelectedSchoolname.Select(x => x.seedcode).ToList())); }();

        $('#listSelectedSchoolname').multiselect({
            buttonWidth: '80%',
            nonSelectedText: '--- Please Select School ---',
            maxHeight: 200,
            enableFiltering: true,
            numberDisplayed: 2,
            onDropdownShow: function (event) {
                var selectedOptions = $('#listSelectedSchoolname option:selected');
                if (selectedOptions.length == 0) {
                    $('#buttonGetData').prop('disabled', true);
                } else if (selectedOptions.length >= 2) {
                    // Disable all other checkboxes.
                    var nonSelectedOptions = $('#listSelectedSchoolname option').filter(function () {
                        return !$(this).is(':selected');
                    });

                    var dropdown = $('listSelectedSchoolname').siblings('.multiselect-container');
                    nonSelectedOptions.each(function () {
                        var input = $('input[value="' + $(this).val() + '"]');
                        input.prop('disabled', true);
                        input.parent('li').addClass('disabled');
                    });
                }
                else {
                    // Enable all checkboxes.
                    var dropdown = $('#listSelectedSchoolname').siblings('.multiselect-container');
                    $('#listSelectedSchoolname option').each(function () {
                        var input = $('input[value="' + $(this).val() + '"]');
                        input.prop('disabled', false);
                        input.parent('li').addClass('disabled');
                    });
                    $('#buttonGetData').prop('disabled', false);
                }
            },
            onChange: function (option, checked) {
                // Get selected options.
                var selectedOptions = $('#listSelectedSchoolname option:selected');
                if (selectedOptions.length == 0) {
                    $('#buttonGetData').prop('disabled', true);
                } else if (selectedOptions.length >= 2) {
                    // Disable all other checkboxes.
                    var nonSelectedOptions = $('#listSelectedSchoolname option').filter(function () {
                        return !$(this).is(':selected');
                    });

                    var dropdown = $('listSelectedSchoolname').siblings('.multiselect-container');
                    nonSelectedOptions.each(function () {
                        var input = $('input[value="' + $(this).val() + '"]');
                        input.prop('disabled', true);
                        input.parent('li').addClass('disabled');
                    });
                }
                else {
                    // Enable all checkboxes.
                    var dropdown = $('#listSelectedSchoolname').siblings('.multiselect-container');
                    $('#listSelectedSchoolname option').each(function () {
                        var input = $('input[value="' + $(this).val() + '"]');
                        input.prop('disabled', false);
                        input.parent('li').addClass('disabled');
                    });
                    $('#buttonGetData').prop('disabled', false);
                }
            }
        });
        $('#listSelectedSchoolname').multiselect('select', selectid);

        $('#listSelectedSchoolname').multiselect('refresh');

    });
</script>
<body>
    <!-- Page Content -->
    <div class="container">
            <div class="row">
                <!-- Sidebar Column -->
                @*<div class="col-md-2">
                    <div class="list-group">
                        <a href="@Url.Action("Nationality", "IndexSchoolProfiles", new { Area = "SchoolProfiles", sSchoolType = "2" }, null)" class="list-group-item">Nationality</a>
                        <a href="@Url.Action("Ethnicity", "IndexSchoolProfiles", new { area = "SchoolProfiles", sSchoolType = "2" }, null)" class="list-group-item">Ethnicity</a>
                    </div>
                </div>*@
                <div class="col-md-12">
                    <div class="panel panel-primary text-center">
                        <div class="panel-heading">
                            <h3 class="panel-title">Please Select Primary Schools</h3>
                        </div>
                        <div class="panel-body">
                            <p> <font color="red">* You can select up to 2 schools for comparison</font></p>
                            @using (Html.BeginForm("GetPrimaryProfileData", "IndexPrimaryProfile", new { area = "SchoolProfiles", sSchoolType = "2" }))
                            {
                                <table class="table table-bordered">
                                    <tbody>
                                        <tr rowspan="2">
                                            <td class="text-left" width="10%">
                                                School Name
                                            </td>
                                            <td class="text-left" colspan="2">
                                                @Html.DropDownListFor(x => x.listSelectedSchoolname, new MultiSelectList(Model.listSchoolname, "seedcode", "name"), new { Multiple = "multiple" })                                             
                                                </td>
                                            @*<td class="text-center" width="20%"> * Maximum 3 Schools </td>*@

                                        </tr>
                                        <tr>
                                            <td class="text-left">Year</td>
                                            <td class="text-left" colspan="2">@Html.DropDownListFor(x => x.selectedYear, new SelectList(Model.listYears, "year", "academicyear"))</td>
                                        </tr>
                                    <tbody>
                                </table>
                                <p><button id="buttonGetData" type="submit" class="btn btn-primary">Get Data!</button></p>

                            }
                            @*<td>@Html.DropDownListFor(x => x.listSelectedGender, Model.listGender.Select(x => new SelectListItem { Text = x.fullName, Value = x.id, Selected = x.selected}), new { Multiple = "multiple" })</td>*@

                        </div>
                        </div>
                    </div>
            </div>

        @if (Model.dataTablePIPS != null && Model.dataTablePIPS.Rows.Count > 0)
        {
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav nav-tabs">
                    <li role="presentation" class="active"><a href="@Url.Action("GetSessionPrimaryProfileData", "IndexPrimaryProfile", new { Area = "SchoolProfiles", datatitle = "nationality" }, null) ">Nationality</a></li>
                    <li role="presentation"><a data-toggle="pill" href="@Url.Action("GetSessionPrimaryProfileData", "IndexPrimaryProfile", new { Area = "SchoolProfiles", datatitle = "nationality" }, null) ">PIPS</a></li>
                    <li role="presentation"><a  href="#">InCAS</a></li>
                    <li role="presentation"><a href="#">Attendance</a></li>
                    <li role="presentation"><a href="#">Exclusions</a></li>
                    <li role="presentation"><a href="#">FSM</a></li>
                    <li role="presentation"><a href="#">School Roll</a></li>
                    <li role="presentation"><a href="#">Look After</a></li>
                    <li role="presentation"><a href="#">EAL</a></li>
                    <li role="presentation"><a data-toggle="pill" href="@Url.Action("GetSessionPrimaryProfileData", "IndexPrimaryProfile", new { Area = "SchoolProfiles", datatitle = "ethnicity" }, null) ">Ethnicity</a></li>
                    <li role="presentation"><a data-toggle="pill" href="@Url.Action("GetSessionPrimaryProfileData", "IndexPrimaryProfile", new { Area = "SchoolProfiles", datatitle = "nationality" }, null) ">Nationality</a></li>
                </ul>
            </div>

           <hr />
            <div class="row">
                <div class="col-md-12">
                    <div class="panel panel-primary text-center">
                        <h3 class="text-center"> <strong> @Model.profiletitle</strong></h3>
                        <h3 class="text-center"> <strong>Value Added Assessment @Model.selectedYear.academicyear </strong></h3>
                        
                    </div>
                </div>
            </div>

                <!-- Content Row -->
                <div class="row">
                    <div class="col-md-12">
                        <div class="panel panel-primary text-center">
                            <div class="panel-heading">
                                <h4 class="panel-title"> <a onclick="goToCreateURL(this)" href="@Url.Content("~")SchoolProfile/Nationality/Index/"><strong>PIPS Baseline </strong></a></h4>
                            </div>
                            <div class="panel-body">
                                <div class="table-responsive">
                                    <p></p>
                                    <table id="PIPSDatatable" class="table table-bordered table-hover">
                                        <thead>
                                            <tr>
                                                @foreach (DataColumn col in Model.dataTablePIPS.Columns)
                                            {
                                                if (Model.dataTablePIPS.Columns.IndexOf(col) == 0)
                                                {

                                            <th class="text-center">@col.ColumnName</th>
                                                }
                                                else
                                                {
                                            <th class="text-center">@col.ColumnName</th>
                                                }
                                            }
                                            </tr>
                                        </thead>
                                        <tbody>
                                            @foreach (DataRow row in Model.dataTablePIPS.Rows)
                                        {
                                        <tr>
                                            @foreach (DataColumn col in Model.dataTablePIPS.Columns)
                                                {
                                                    if (Model.dataTablePIPS.Columns.IndexOf(col) == 0)
                                                    {
                                                        <td class="text-left">@row[col.ColumnName]</td>


                                                        //<td class="text-left"><a href="@Url.Action("GetTrendData", "IndexSchoolProfiles", new { Area = "SchoolProfiles", sSchoolType = "2", datatitle = "pips", sSchoolName = row[col.ColumnName] }, null)">@row[col.ColumnName]</a></td>
                                                    }
                                                    else
                                                    {
                                                <td>
                                                    @row[col.ColumnName]
                                                    @*<input enabled type="button" class="btn btn-info btn-xs enabled" style="width: 50px; height:25px" value="Pupils" onclick="location.href='@Url.Action("GetPrimaryListpupils", "IndexSchoolProfiles", new { area = "SchoolProfiles", datatitle = "stage", Indexrow = Model.DataTableStage.Rows.IndexOf(row), Indexcol = Model.DataTableStage.Columns.IndexOf(col.ColumnName) })'" />*@
                                                </td>
                                                    }
                                                @*<td>Model.ethnicityData.Rows.IndexOf(row)</td>*@
                                                @*<td>@Model.ethnicityData.Columns.IndexOf(col)</td>*@

                                                }
                                        </tr>
                                        }
                                        </tbody>
                                    </table>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
        }
        
        @if (Model.showTableInCAS.HasValue)
        {
            <hr />
            <div class="row">
                <div class="col-md-12">
                    <div class="panel panel-primary text-center">
                        <h3 class="text-center"> <strong> @Model.profiletitle </strong></h3>
                        <h3 class="text-center"> <strong> Assessment for Excellent [InCAS] @Model.selectedYear.academicyear</strong></h3>

                    </div>
                </div>
            </div>

            if (Model.showTableInCAS.Value == true)
            {
                <!-- Content Row -->
                <div class="row">
                    <div class="col-md-12">
                        <div class="panel panel-primary text-center">
                            <div class="panel-heading">
                                <h4 class="panel-title"> <a onclick="goToCreateURL(this)" href="@Url.Content("~")SchoolProfile/Nationality/Index/"> <strong>InCAS</strong></a></h4>
                            </div>
                            <div class="panel-body">
                                <div class="table-responsive">
                                    <p></p>
                                    <table id="InCASP2Datatable" class="table table-bordered table-hover displayDTTableV">
                                        <thead>
                                            @{var colspan = (Model.dataTableInCASP2.Columns.Count) + 1;}
                                            <tr class="bg-primary">
                                                <td colspan=@colspan><strong>P2</strong></td>
                                            </tr>
                                            <tr>
                                                @foreach (DataColumn col in Model.dataTableInCASP2.Columns)
                                                {
                                                    if (Model.dataTableInCASP2.Columns.IndexOf(col) == 0)
                                                    {

                                                        <th class="text-center"></th>
                                                    }
                                                    else
                                                    {
                                                        <th class="text-center">@col.ColumnName</th>
                                                    }
                                                }
                                            </tr>
                                        </thead>
                                        <tbody>
                                            @foreach (DataRow row in Model.dataTableInCASP2.Rows)
                                            {
                                                <tr>
                                                    @foreach (DataColumn col in Model.dataTableInCASP2.Columns)
                                                    {
                                                        if (Model.dataTableInCASP2.Columns.IndexOf(col) == 0)
                                                        {
                                                            <td class="text-left">@row[col.ColumnName]</td>


                                                            //<td class="text-left"><a href="@Url.Action("GetTrendData", "IndexSchoolProfiles", new { Area = "SchoolProfiles", sSchoolType = "2", datatitle = "pips", sSchoolName = row[col.ColumnName] }, null)">@row[col.ColumnName]</a></td>
                                                        }
                                                        else
                                                        {
                                                            <td>
                                                                @row[col.ColumnName]
                                                                @*<input enabled type="button" class="btn btn-info btn-xs enabled" style="width: 50px; height:25px" value="Pupils" onclick="location.href='@Url.Action("GetPrimaryListpupils", "IndexSchoolProfiles", new { area = "SchoolProfiles", datatitle = "stage", Indexrow = Model.DataTableStage.Rows.IndexOf(row), Indexcol = Model.DataTableStage.Columns.IndexOf(col.ColumnName) })'" />*@
                                                            </td>
                                                        }
                                                        @*<td>Model.ethnicityData.Rows.IndexOf(row)</td>*@
                                                        @*<td>@Model.ethnicityData.Columns.IndexOf(col)</td>*@

                                                    }
                                                </tr>
                                            }
                                        </tbody>
                                    </table>
                                </div>

                                <div class="table-responsive">
                                    <p></p>
                                    <table id="InCASP4Datatable" class="table table-bordered table-hover displayDTTableV">
                                        <thead>
                                            @{colspan = (Model.dataTableInCASP4.Columns.Count) + 1;}
                                            <tr class="bg-primary">
                                                <td colspan=@colspan><strong>P4</strong></td>
                                            </tr>
                                            <tr>
                                                @foreach (DataColumn col in Model.dataTableInCASP4.Columns)
                                                {
                                                    if (Model.dataTableInCASP4.Columns.IndexOf(col) == 0)
                                                    {

                                                        <th class="text-center"></th>
                                                    }
                                                    else
                                                    {
                                                        <th class="text-center">@col.ColumnName</th>
                                                    }
                                                }
                                            </tr>
                                        </thead>
                                        <tbody>
                                            @foreach (DataRow row in Model.dataTableInCASP4.Rows)
                                            {
                                                <tr>
                                                    @foreach (DataColumn col in Model.dataTableInCASP4.Columns)
                                                    {
                                                        if (Model.dataTableInCASP4.Columns.IndexOf(col) == 0)
                                                        {
                                                            <td class="text-left">@row[col.ColumnName]</td>


                                                            //<td class="text-left"><a href="@Url.Action("GetTrendData", "IndexSchoolProfiles", new { Area = "SchoolProfiles", sSchoolType = "2", datatitle = "pips", sSchoolName = row[col.ColumnName] }, null)">@row[col.ColumnName]</a></td>
                                                        }
                                                        else
                                                        {
                                                            <td>
                                                                @row[col.ColumnName]
                                                                @*<input enabled type="button" class="btn btn-info btn-xs enabled" style="width: 50px; height:25px" value="Pupils" onclick="location.href='@Url.Action("GetPrimaryListpupils", "IndexSchoolProfiles", new { area = "SchoolProfiles", datatitle = "stage", Indexrow = Model.DataTableStage.Rows.IndexOf(row), Indexcol = Model.DataTableStage.Columns.IndexOf(col.ColumnName) })'" />*@
                                                            </td>
                                                        }
                                                        @*<td>Model.ethnicityData.Rows.IndexOf(row)</td>*@
                                                        @*<td>@Model.ethnicityData.Columns.IndexOf(col)</td>*@

                                                    }
                                                </tr>
                                            }
                                        </tbody>
                                    </table>
                                </div>

                                <div class="table-responsive">
                                    <p></p>
                                    <table id="InCASP6Datatable" class="table table-bordered table-hover displayDTTableV">
                                        <thead >
                                            @{colspan = (Model.dataTableInCASP6.Columns.Count) + 1;}
                                            <tr class="bg-primary">
                                                <td colspan=@colspan><strong>P6</strong></td>
                                            </tr>
                                            <tr>
                                                @foreach (DataColumn col in Model.dataTableInCASP6.Columns)
                                                {
                                                    if (Model.dataTableInCASP6.Columns.IndexOf(col) == 0)
                                                    {

                                                        <th class="text-center"></th>
                                                    }
                                                    else
                                                    {
                                                        <th class="text-center">@col.ColumnName</th>
                                                    }
                                                }
                                            </tr>
                                        </thead>
                                        <tbody>
                                            @foreach (DataRow row in Model.dataTableInCASP6.Rows)
                                            {
                                                <tr>
                                                    @foreach (DataColumn col in Model.dataTableInCASP6.Columns)
                                                    {
                                                        if (Model.dataTableInCASP6.Columns.IndexOf(col) == 0)
                                                        {
                                                            <td class="text-left">@row[col.ColumnName]</td>


                                                            //<td class="text-left"><a href="@Url.Action("GetTrendData", "IndexSchoolProfiles", new { Area = "SchoolProfiles", sSchoolType = "2", datatitle = "pips", sSchoolName = row[col.ColumnName] }, null)">@row[col.ColumnName]</a></td>
                                                        }
                                                        else
                                                        {
                                                            <td>
                                                                @row[col.ColumnName]
                                                                @*<input enabled type="button" class="btn btn-info btn-xs enabled" style="width: 50px; height:25px" value="Pupils" onclick="location.href='@Url.Action("GetPrimaryListpupils", "IndexSchoolProfiles", new { area = "SchoolProfiles", datatitle = "stage", Indexrow = Model.DataTableStage.Rows.IndexOf(row), Indexcol = Model.DataTableStage.Columns.IndexOf(col.ColumnName) })'" />*@
                                                            </td>
                                                        }
                                                        @*<td>Model.ethnicityData.Rows.IndexOf(row)</td>*@
                                                        @*<td>@Model.ethnicityData.Columns.IndexOf(col)</td>*@

                                                    }
                                                </tr>
                                            }
                                        </tbody>
                                    </table>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
            }
            else
            {
                <div class="row">
                    <div class="col-md-12">
                        <div class="panel panel-primary text-center">

                            <div class="panel-heading">
                                <h4 class="panel-title"> <strong> Data is not available </strong> </h4>
                            </div>
                        </div>
                    </div>
                </div>


            }
        }
 
        @if (Model.showTableAttendance.HasValue)
        {
            if (Model.showTableAttendance.Value == true && Model.dataTableAttendance.Rows.Count > 0)
            {
                <hr>
                <div class="row">
                    <div class="col-md-12">
                        <div class="panel panel-primary text-center">
                            <h3 class="text-center"> <strong> @Model.profiletitle </strong></h3>
                            <h3 class="text-center"><strong>Pupil Census Information for @Model.selectedYear.academicyear</strong></h3>
                        </div>
                    </div>
                </div>
                <!-- Content Row -->
                <div class="row">
                    <div class="col-md-12">
                        <div class="panel panel-primary text-center">
                            <div class="panel-heading">
                                <h4 class="panel-title"> <a onclick="goToCreateURL(this)" href="@Url.Content("~")SchoolProfile/Nationality/Index/"><strong>Attendance</strong></a></h4>
                            </div>
                            <div class="panel-body">
                                <div class="table-responsive">
                                    <p><strong>% of Attendance </strong></p>
                                    <table id="AttendanceDatatable" class="table table-bordered table-hover">
                                        <thead>
                                            <tr>
                                                @foreach (DataColumn col in Model.dataTableAttendance.Columns)
                                                {
                                                    if (Model.dataTableAttendance.Columns.IndexOf(col) == 0)
                                                    {

                                                        <th class="text-center">@col.ColumnName</th>
                                                    }
                                                    else
                                                    {
                                                        <th class="text-center">@col.ColumnName</th>
                                                    }
                                                }
                                            </tr>
                                        </thead>
                                        <tbody>
                                            @foreach (DataRow row in Model.dataTableAttendance.Rows)
                                            {
                                                <tr>
                                                    @foreach (DataColumn col in Model.dataTableAttendance.Columns)
                                                    {
                                                        if (Model.dataTableAttendance.Columns.IndexOf(col) == 0)
                                                        {

                                                            <td class="text-left">@row[col.ColumnName]</td>

                                                            @*<td class="text-left"><a href="@Url.Action("GetTrendData", "IndexSchoolProfiles", new { Area = "SchoolProfiles", sSchoolType = "2", datatitle = "stage", sSchoolName = row[col.ColumnName] }, null)">@row[col.ColumnName]</a></td>*@
                                                        }
                                                        else
                                                        {
                                                            <td>
                                                                @row[col.ColumnName]
                                                                @*<input enabled type="button" class="btn btn-info btn-xs enabled" style="width: 50px; height:25px" value="Pupils" onclick="location.href='@Url.Action("GetPrimaryListpupils", "IndexSchoolProfiles", new { area = "SchoolProfiles", datatitle = "stage", Indexrow = Model.DataTableStage.Rows.IndexOf(row), Indexcol = Model.DataTableStage.Columns.IndexOf(col.ColumnName) })'" />*@
                                                            </td>
                                                        }
                                                        @*<td>Model.ethnicityData.Rows.IndexOf(row)</td>*@
                                                        @*<td>@Model.ethnicityData.Columns.IndexOf(col)</td>*@

                                                    }
                                                </tr>
                                            }
                                        </tbody>
                                    </table>
                                    <p class="text-right"><a href="http://www.gov.scot/Topics/Statistics/Browse/School-Education/AttendanceAbsenceDatasets/atttab2015">Attendance and Absence in Scottish Schools 2014/15: Scottish Government Publication</a></p>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
            }
            else
            {
                <hr>
                <div class="row">
                    <div class="col-md-12">
                        <div class="panel panel-primary text-center">
                            <h3 class="text-center"><strong>@Model.profiletitle</strong></h3>
                            <h3 class="text-center"><strong>Pupil Census Information for @Model.selectedYear.academicyear</strong></h3>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <div class="panel panel-primary text-center">
                            <div class="panel-heading">
                                <h4 class="panel-title"> <a onclick="goToCreateURL(this)" href="@Url.Content("~")SchoolProfile/Nationality/Index/"><strong>Attendance</strong></a></h4>
                            </div>
                            <div class="panel-body">
                                <h4 class="panel-title"> <strong> <em>Data is not available </em> </strong></h4>
                            </div>
                        </div>
                    </div>
                </div>

            }
        }

        @if (Model.showTableExclusion.HasValue)
        {
            if (Model.showTableExclusion.Value == true && Model.dataTableExclusion.Rows.Count > 0)
            {
                <hr>
                <!-- Content Row -->
                <div class="row">
                    <div class="col-md-12">
                        <div class="panel panel-primary text-center">
                            <div class="panel-heading">
                                <h4 class="panel-title"> <a onclick="goToCreateURL(this)" href="@Url.Content("~")SchoolProfile/Nationality/Index/"> <strong>Exclusions-Annual</strong></a></h4>
                            </div>
                            <div class="panel-body">
                                <div class="table-responsive">
                                    <p> <strong>Pupil Numbers</strong></p>
                                    <table id="ExclusionDatatable" class="table table-bordered table-hover">
                                        <thead>
                                            <tr>
                                                @foreach (DataColumn col in Model.dataTableExclusion.Columns)
                                                {
                                                    if (Model.dataTableExclusion.Columns.IndexOf(col) == 0)
                                                    {

                                                        <th class="text-center">@col.ColumnName</th>
                                                    }
                                                    else
                                                    {
                                                        <th class="text-center">@col.ColumnName</th>
                                                    }
                                                }
                                            </tr>
                                        </thead>
                                        <tbody>
                                            @foreach (DataRow row in Model.dataTableExclusion.Rows)
                                            {
                                                <tr>
                                                    @foreach (DataColumn col in Model.dataTableExclusion.Columns)
                                                    {
                                                        if (Model.dataTableExclusion.Columns.IndexOf(col) == 0)
                                                        {
                                                            <td class="text-left">@row[col.ColumnName]</td>


                                                            @*<td class="text-left"><a href="@Url.Action("GetTrendData", "IndexSchoolProfiles", new { Area = "SchoolProfiles", sSchoolType = "2", datatitle = "stage", sSchoolName = row[col.ColumnName] }, null)">@row[col.ColumnName]</a></td>*@
                                                        }
                                                        else
                                                        {
                                                            <td>
                                                                @row[col.ColumnName]
                                                                @*<input enabled type="button" class="btn btn-info btn-xs enabled" style="width: 50px; height:25px" value="Pupils" onclick="location.href='@Url.Action("GetPrimaryListpupils", "IndexSchoolProfiles", new { area = "SchoolProfiles", datatitle = "stage", Indexrow = Model.DataTableStage.Rows.IndexOf(row), Indexcol = Model.DataTableStage.Columns.IndexOf(col.ColumnName) })'" />*@
                                                            </td>
                                                        }
                                                        @*<td>Model.ethnicityData.Rows.IndexOf(row)</td>*@
                                                        @*<td>@Model.ethnicityData.Columns.IndexOf(col)</td>*@

                                                    }
                                                </tr>
                                            }
                                        </tbody>
                                    </table>
                                    <p class="text-right"><a href="http://www.gov.scot/Topics/Statistics/Browse/School-Education/exclusiondatasets/exclusionsdataset2015">Exclusions from Schools 2014/15: Scottish Government Publication</a></p>

                                </div>

                            </div>
                        </div>
                    </div>
                </div>
            }            
            else
            {
                <hr />
                <div class="row">
                    <div class="col-md-12">
                        <div class="panel panel-primary text-center">
                            <div class="panel-heading">
                                <h4 class="panel-title"> <a onclick="goToCreateURL(this)" href="@Url.Content("~")SchoolProfile/Nationality/Index/"> <strong>Exclusions-Annual </strong></a></h4>
                            </div>
                            <div class="panel-body">
                                <h4 class="panel-title"> <strong> <em>Data is not available </em> </strong> </h4>
                            </div>
                        </div>
                    </div>
                </div>

            }
        }
        
        @if (Model.dataTableFreeSchoolMeal != null && Model.dataTableFreeSchoolMeal.Rows.Count > 0)
        {
            <hr>
            <!-- Content Row -->
            <div class="row">
                <div class="col-md-12">
                    <div class="panel panel-primary text-center">
                        <div class="panel-heading">
                            <h4 class="panel-title"> <a onclick="goToCreateURL(this)" href="@Url.Content("~")SchoolProfile/Nationality/Index/"><strong>Free School Meal Entitlement</strong></a></h4>
                        </div>
                        <div class="panel-body">
                            <div class="table-responsive">
                                <p> <strong>% of P4-P7 Roll Registered for FSM @Model.selectedYear.academicyear </strong></p>
                                <table id="FreeMealDatatable" class="table table-bordered table-hover">
                                    <thead>
                                        <tr>
                                            @foreach (DataColumn col in Model.dataTableFreeSchoolMeal.Columns)
                                            {
                                                if (Model.dataTableFreeSchoolMeal.Columns.IndexOf(col) == 0)
                                                {

                                                    <th class="text-center">@col.ColumnName</th>
                                                }
                                                else
                                                {
                                                    <th class="text-center">@col.ColumnName</th>
                                                }
                                            }
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @foreach (DataRow row in Model.dataTableFreeSchoolMeal.Rows)
                                        {
                                            <tr>
                                                @foreach (DataColumn col in Model.dataTableFreeSchoolMeal.Columns)
                                                {
                                                    if (Model.dataTableFreeSchoolMeal.Columns.IndexOf(col) == 0)
                                                    {

                                                        <td class="text-left">@row[col.ColumnName]</td>

                                                        @*<td class="text-left"><a href="@Url.Action("GetTrendData", "IndexSchoolProfiles", new { Area = "SchoolProfiles", sSchoolType = "2", datatitle = "stage", sSchoolName = row[col.ColumnName] }, null)">@row[col.ColumnName]</a></td>*@
                                                    }
                                                    else
                                                    {
                                                        <td>
                                                            @row[col.ColumnName]
                                                            @*<input enabled type="button" class="btn btn-info btn-xs enabled" style="width: 50px; height:25px" value="Pupils" onclick="location.href='@Url.Action("GetPrimaryListpupils", "IndexSchoolProfiles", new { area = "SchoolProfiles", datatitle = "stage", Indexrow = Model.DataTableStage.Rows.IndexOf(row), Indexcol = Model.DataTableStage.Columns.IndexOf(col.ColumnName) })'" />*@
                                                        </td>
                                                    }
                                                    @*<td>Model.ethnicityData.Rows.IndexOf(row)</td>*@
                                                    @*<td>@Model.ethnicityData.Columns.IndexOf(col)</td>*@

                                                }
                                            </tr>
                                        }
                                    </tbody>
                                </table>
                                <p class="text-right"><a href="http://www.gov.scot/Topics/Statistics/Browse/School-Education/SchoolMealsDatasets/schmeals2015">School Meals in Scotland 2015:Scottish Government Publication 2015</a></p>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        }
        
        @if (Model.dataTableStage != null && Model.dataTableStage.Rows.Count > 0)
        {
                    <hr>
            <!-- Content Row -->
                    <div class="row">
                        <div class="col-md-12">
                            <div class="panel panel-primary text-center">
                                <div class="panel-heading">
                                    <h4 class="panel-title"> <a onclick="goToCreateURL(this)" href="@Url.Content("~")SchoolProfile/Nationality/Index/"> <strong>School Roll Year Groups</strong></a></h4>
                                </div>
                                <div class="panel-body">
                                    <div class="table-responsive">
                                        <p> <strong> Pupil Numbers in Each Year Groups </strong></p>
                                        <table id="StageDatatable" class="table table-bordered table-hover">
                                            <thead>
                                                <tr>
                                                    @foreach (DataColumn col in Model.dataTableStage.Columns)
                                        {
                                            if (Model.dataTableStage.Columns.IndexOf(col) == 0)
                                            {

                                            <th class="text-center">@col.ColumnName</th>
                                            }
                                            else
                                            {
                                            <th class="text-center">@col.ColumnName</th>
                                            }
                                        }
                                                </tr>
                                            </thead>
                                            <tbody>
                                                @foreach (DataRow row in Model.dataTableStage.Rows)
                                    {
                                        <tr>
                                            @foreach (DataColumn col in Model.dataTableStage.Columns)
                                            {
                                                if (Model.dataTableStage.Columns.IndexOf(col) == 0)
                                                {
                                                    <td class="text-left">@row[col.ColumnName]</td>


                                        @*<td class="text-left"><a href="@Url.Action("GetTrendData", "IndexSchoolProfiles", new { Area = "SchoolProfiles", sSchoolType = "2", datatitle = "stage", sSchoolName = row[col.ColumnName] }, null)">@row[col.ColumnName]</a></td>*@
                                                }
                                                else
                                                {
                                        <td>
                                            @row[col.ColumnName]
                                        @*<input enabled type="button" class="btn btn-info btn-xs enabled" style="width: 50px; height:25px" value="Pupils" onclick="location.href='@Url.Action("GetPrimaryListpupils", "IndexSchoolProfiles", new { area = "SchoolProfiles", datatitle = "stage", Indexrow = Model.DataTableStage.Rows.IndexOf(row), Indexcol = Model.DataTableStage.Columns.IndexOf(col.ColumnName) })'" />*@
                                    </td>
                                                }
                                        @*<td>Model.ethnicityData.Rows.IndexOf(row)</td>*@
                                        @*<td>@Model.ethnicityData.Columns.IndexOf(col)</td>*@

                                            }
                                        </tr>
                                    }
                                            </tbody>
                                        </table>
                                        <p class="text-right"><a href="http://www.gov.scot/Topics/Statistics/Browse/School-Education/dspupcensus/dspupcensus15">Pupils in Scotland 2015: Scottish Government Publication</a></p>

                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>
        }



                @if (Model.dataTableLookedAfter != null && Model.dataTableLookedAfter.Rows.Count > 0)
        {
                    <hr>
            <!-- Content Row -->
                    <div class="row">
                        <div class="col-md-12">
                            <div class="panel panel-primary text-center">
                                <div class="panel-heading">
                                    <h4 class="panel-title"> <a onclick="goToCreateURL(this)" href="@Url.Content("~")SchoolProfile/Nationality/Index/"> <strong>Looked After Children</strong></a></h4>
                                </div>
                                <div class="panel-body">
                                    <div class="table-responsive">
                                        <p> <strong>% School Roll Looked After @Model.selectedYear.academicyear </strong></p>
                                        <table id="LookedAfterDatatable" class="table table-bordered table-hover">
                                            <thead>
                                                <tr>
                                                    @foreach (DataColumn col in Model.dataTableLookedAfter.Columns)
                                            {
                                                if (Model.dataTableLookedAfter.Columns.IndexOf(col) == 0)
                                                {

                                                    <th class="text-center">@col.ColumnName</th>
                                                }
                                                else
                                                {
                                                    <th class="text-center">@col.ColumnName</th>
                                                }
                                            }
                                                </tr>
                                            </thead>
                                            <tbody>
                                                @foreach (DataRow row in Model.dataTableLookedAfter.Rows)
                                        {
                                                    <tr>
                                                        @foreach (DataColumn col in Model.dataTableLookedAfter.Columns)
                                                {
                                                    if (Model.dataTableLookedAfter.Columns.IndexOf(col) == 0)
                                                    {
                                                        <td class="text-left">@row[col.ColumnName]</td>


                                                        @*<td class="text-left"><a href="@Url.Action("GetTrendData", "IndexSchoolProfiles", new { Area = "SchoolProfiles", sSchoolType = "2", datatitle = "lookafter", sSchoolName = row[col.ColumnName] }, null)">@row[col.ColumnName]</a></td>*@
                                                    }
                                                    else
                                                    {
                                                        <td>
                                                            @row[col.ColumnName]
                                                            @*<input enabled type="button" class="btn btn-info btn-xs enabled" style="width: 50px; height:25px" value="Pupils" onclick="location.href='@Url.Action("GetPrimaryListpupils", "IndexSchoolProfiles", new { area = "SchoolProfiles", datatitle = "stage", Indexrow = Model.DataTableStage.Rows.IndexOf(row), Indexcol = Model.DataTableStage.Columns.IndexOf(col.ColumnName) })'" />*@
                                                        </td>
                                                    }
                                                    @*<td>Model.ethnicityData.Rows.IndexOf(row)</td>*@
                                                            @*<td>@Model.ethnicityData.Columns.IndexOf(col)</td>*@

                                                }
                                                    </tr>
                                        }
                                            </tbody>
                                        </table>
                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>
        }

                @if (Model.dataTableEnglishLevel != null && Model.dataTableEnglishLevel.Rows.Count > 0)
        {
                    <hr>
            <!-- Content Row -->
                    <div class="row">
                        <div class="col-md-12">
                            <div class="panel panel-primary text-center">
                                <div class="panel-heading">
                                    <h4 class="panel-title"> <a onclick="goToCreateURL(this)" href="@Url.Content("~")SchoolProfile/Nationality/Index/"> <strong> Level of English </strong></a></h4>
                                </div>
                                <div class="panel-body">
                                    <p> <strong> % of pupils with this level of English </strong></p>
                                    <table id="EnglishLevelDatatable" class="table table-bordered table-hover">
                                        <thead>
                                            <tr>
                                                @foreach (DataColumn col in Model.dataTableEnglishLevel.Columns)
                                        {
                                            if (Model.dataTableEnglishLevel.Columns.IndexOf(col) == 0)
                                            {

                                                <th class="text-center">@col.ColumnName</th>
                                            }
                                            else
                                            {
                                                <th class="text-center"><a href="@Url.Action("GetTrendData", "IndexSchoolProfiles", new { Area = "SchoolProfiles", sSchoolType = "2", datatitle = "englishlevel", sSchoolName = col.ColumnName }, null)">@col.ColumnName</a></th>
                                            }
                                        }
                                            </tr>
                                        </thead>
                                        <tbody>
                                            @foreach (DataRow row in Model.dataTableEnglishLevel.Rows)
                                    {
                                                <tr>
                                                    @foreach (DataColumn col in Model.dataTableEnglishLevel.Columns)
                                                    {
                                                        if (Model.dataTableEnglishLevel.Columns.IndexOf(col) == 0)
                                                        {

                                                            <td class="text-left">@row[col.ColumnName]</td>
                                                    @*<td class="text-left"><a href="@Url.Action("GetTrendData", "IndexSchoolProfiles", new { Area = "SchoolProfiles", sSchoolType = "2", datatitle = "englishlevel", sSchoolName = row[col.ColumnName] }, null)">@row[col.ColumnName]</a></td>*@
                                                }
                                                else
                                                {
                                                    <td>
                                                        @row[col.ColumnName]
                                                    @*<input enabled type="button" class="btn btn-info btn-xs enabled" style="width: 50px; height:25px" value="@row[col.ColumnName]" onclick="location.href='@Url.Action("GetPrimaryListpupils", "IndexSchoolProfiles", new { area = "SchoolProfiles", sSchoolType = "2", datatitle = "englishlevel", Indexrow = Model.englishLevelDataTable.Rows.IndexOf(row), Indexcol = Model.englishLevelDataTable.Columns.IndexOf(col.ColumnName) })'" />*@
                                                </td>
                                                }
                                                @*<td>Model.ethnicityData.Rows.IndexOf(row)</td>*@
                                                        @*<td>@Model.ethnicityData.Columns.IndexOf(col)</td>*@

                                            }
                                                </tr>
                                    }
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                                    <!-- Graph Row -->
                    <div class="row">
                        <div class="col-md-12">
                            <div id="EnglishLevelGraphContainer" style="width: 100%;"></div>
                        </div>
                    </div>
        }
                @if (Model.dataTableEthnicBackground != null && Model.dataTableEthnicBackground.Rows.Count > 0)
        {
                    <hr>
            <!-- Content Row -->
                    <div class="row">
                        <div class="col-md-12">
                            <div class="panel panel-primary text-center">
                                <div class="panel-heading">
                                    <h4 class="panel-title"> <a onclick="goToCreateURL(this)" href="@Url.Content("~")SchoolProfile/Nationality/Index/"> <strong>Ethnicity </strong></a></h4>
                                </div>
                                <div class="panel-body">
                                    <div class="table-responsive">
                                        <p> <strong> % of pupils of each ethnic group </strong></p>
                                        <table id="Ethnicdatatable" class="table table-bordered table-hover">
                                            <thead>
                                                <tr>
                                                    @foreach (DataColumn col in Model.dataTableEthnicBackground.Columns)
                                            {
                                                if (Model.dataTableEthnicBackground.Columns.IndexOf(col) == 0)
                                                {

                                                    <th class="text-center no-sort">@col.ColumnName</th>
                                                }
                                                else
                                                {
                                                    <th class="text-center"><a href="@Url.Action("GetTrendData", "IndexSchoolProfiles", new { Area = "SchoolProfiles", sSchoolType = "2", datatitle = "ethnicity", sSchoolName = col.ColumnName }, null)">@col.ColumnName</a></th>

                                                }
                                            }
                                                </tr>
                                            </thead>
                                            <tbody>
                                                @foreach (DataRow row in Model.dataTableEthnicBackground.Rows)
                                    {
                                                    <tr>
                                                        @foreach (DataColumn col in Model.dataTableEthnicBackground.Columns)
                                                        {
                                                            if (Model.dataTableEthnicBackground.Columns.IndexOf(col) == 0)
                                                            {
                                                                <td class="text-left">@row[col.ColumnName]</td>
                                                    @*<td class="text-left"><a href="@Url.Action("GetTrendData", "IndexSchoolProfiles", new { Area = "SchoolProfiles", sSchoolType = "2", datatitle = "ethnicity", sSchoolName = row[col.ColumnName] }, null)">@row[col.ColumnName]</a></td>*@
                                                }
                                                else
                                                {
                                                    <td class="text-center">@row[col.ColumnName]</td>
                                                            @*<td>
                                                                    <input enabled type="button" class="btn btn-info btn-xs enabled" style="width: 50px; height:25px" value="@row[col.ColumnName]" onclick="location.href='@Url.Action("GetPrimaryListpupils", "IndexSchoolProfiles", new { area = "SchoolProfiles", datatitle = "ethnicity", Indexrow = Model.ethnicityDataTable.Rows.IndexOf(row), Indexcol = Model.ethnicityDataTable.Columns.IndexOf(col.ColumnName) })'" />
                                                                </td>*@
                                                }
                                            }
                                                    </tr>
                                    }

                                            </tbody>
                                        </table>
                                        <p>*In 2011 the Scottish Government introduced a new code list for Ethnicity, hence the historic data is not comparable.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                        <!-- Graph Row -->
                    <div class="row">
                        <div class="col-md-12">
                            <div id="EthinicityGraphContainer" style="width: 100%;"></div>

                        </div>
                    </div>
        }

                @if (Model.dataTableNationality != null && Model.dataTableNationality.Rows.Count > 0)
        {
                    <hr>
            <!-- Data Table Row -->
                    <div class="row">
                        <div class="col-md-12">
                            <div class="panel panel-primary text-center">
                                <div class="panel-heading">
                                    <h4 class="panel-title"> <a onclick="goToCreateURL(this)" href="@Url.Content("~")SchoolProfile/Nationality/Index/"> <strong>Nationality</strong></a></h4>
                                </div>
                                <div class="panel-body">
                                    <div class="table-responsive">
                                        <p> <strong>% of pupils of each nationality </strong></p>
                                        <table id="Nationalitydatatable" class="table table-bordered table-hover">
                                            <thead>
                                                <tr>
                                                    @foreach (DataColumn col in Model.dataTableNationality.Columns)
                                        {
                                            if (Model.dataTableNationality.Columns.IndexOf(col) == 0)
                                            {

                                                <th class="text-center">@col.ColumnName</th>
                                           }
                                           else
                                           {
                                                <th class="text-center"><a href="@Url.Action("GetTrendData", "IndexSchoolProfiles", new { Area = "SchoolProfiles", sSchoolType = "2", datatitle = "nationality", sSchoolName = col.ColumnName }, null)">@col.ColumnName</a></th>
                                           }
                                        }
                                                </tr>
                                            </thead>
                                            <tbody>
                                                @foreach (DataRow row in Model.dataTableNationality.Rows)
                                    {
                                                    <tr>
                                                        @foreach (DataColumn col in Model.dataTableNationality.Columns)
                                                        {
                                                            if (Model.dataTableNationality.Columns.IndexOf(col) == 0)
                                                            {
                                                                <td class="text-left">@row[col.ColumnName]</td>
                                                                @*<td class="text-left"><a href="@Url.Action("GetTrendData", "IndexSchoolProfiles", new { Area = "SchoolProfiles", sSchoolType = "2", datatitle = "nationality", sSchoolName = row[col.ColumnName] }, null)">@row[col.ColumnName]</a></td>*@
                                                }
                                                else
                                                {
                                                    <td class="text-center">@row[col.ColumnName]</td>
                                                            @*<td>
                                                                    <input enabled type="button" class="btn btn-info btn-xs enabled" style="width: 50px; height:25px" value=@row[col.ColumnName] onclick="location.href='@Url.Action("GetPrimaryListpupils", "IndexSchoolProfiles", new { area = "SchoolProfiles", datatitle = "nationality", Indexrow = Model.nationalityDataTable.Rows.IndexOf(row), Indexcol = Model.nationalityDataTable.Columns.IndexOf(col.ColumnName) })'" />
                                                                </td>*@
                                                }
                                            }
                                                    </tr>
    }

                                            </tbody>
                                        </table>
                                        <p>*In 2011  the Scottish Government introduced a new code list for Nationality, hence the historic data is not comparable.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
            <!-- Graph Row -->
                    <div class="row">
                        <div class="col-md-12">
                            <div id="NationalityGraphContainer" style="width: 100%;"></div>
                        </div>
                    </div>
        }
        
        

            </div>
    </body>

